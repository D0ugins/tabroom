<%args>
	$person
	$person_settings
	$tourn
	$tourn_settings
	$round_id => undef
	$perms    => undef
	$default  => "seating"
</%args>
<%init>

	my $round = Tab::Round->retrieve($round_id) if $round_id;

	unless ($round) { 
		my $msg = "No valid round ID recieved.  Please hit back and try again";
		$m->comp("/funclib/abort.mas", message => $msg);
	}

	my %round_settings = $round->all_settings;

	my $event = $round->event;
	my %event_settings = $event->all_settings;

	my $category = $event->category if $event;
	my %category_settings = $category->all_settings;

	my @panels = $round->panels;

	my @tabs = ("rooms", "seating");

</%init>

	<div class="main">

		<div class="nospace">
		
			<span class="twofifth nowrap">
				<h2><% $round->realname %> Seating Charts</h2>
			</span>

			<span class="threefifth nowrap">
			
				<span class="threefifths leftalign">
				</span>

			</span>

		</div>

		<& "/funclib/tabs.mas", 
			tabs => \@tabs 
		&>

		<div id="rooms" class="screens hidden">

			<h4>Room Configurations</h4>

			<form 
				action = "seating_rooms_save.mhtml"
				method = "post"
			>

			<input 
				type  = "hidden"
				name  = "round_id"
				value = "<% $round->id %>"
			>

			<& "/funclib/tablesorter.mas", table => "room_configs" &>

			<table id="room_configs">

				<thead>

					<tr class="yellowrow">
						
						<th>
							Chamber
						</th>

						<th>
							Room
						</th>

						<th>
							# Entries
						</th>

						<th>
							# Rows
						</th>

						<th>
							# Seats
						</th>

					</tr>

				</thead>

				<tbody>
<%perl>

			foreach my $panel ($round->panels) { 

				my $room = $panel->room;

				my @entries = $m->comp(
					"/funclib/panel_entries.mas", 
					panel => $panel
				);

				if ($room) { 


</%perl>
					<tr>

						<td>
							<% $panel->letter %>
						</td>

						<td>
							<% $room->name %>
						</td>

						<td>
							<% scalar @entries %>
						</td>

						<td>
							<% $room->rows %>
						</td>

						<td>
							<% $room->columns %>
						</td>

					</div>
%				}

%			}

		</div>


	</div>

