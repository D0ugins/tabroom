<%args>
	$tourn
	$tourn_settings
	$perms
	$person
	$session
</%args>
<%init>

	my @entries = $m->comp("/funclib/tourn_entries.mas", 
		tourn => $tourn, 
		all => "yeah"
	);

</%init>

%   if (${$perms}{"entry_only"}) { 

        <& "/tabbing/entry/menu.mas", 
            whoami         => "entry",
            session        => $session,
            tourn          => $tourn,
            person         => $person,
            entry_only     => 1,
            tourn_settings => $tourn_settings,
            perms          => $perms,
            noclose        => 1
        &>

%   }  else { 

		<div class="menu">

%   }  

		<div class="sidenote">

			<h4>Commands</h4>

<%perl>
			my $warn = "This button will mark ALL entries as dropped. ";
			$warn .= " That could be disastrous, maybe.  You sure?";
</%perl>

			<a 
				class="full yellow" 
				href="deactivate_entries.mhtml?tourn_id=<% $tourn->id %>"
				<& "/funclib/confirm.mas", warn => $warn &>  
			>
				Deactivate All Entries
			</a>

<%perl>
			$warn = "This button will mark ALL entries as un-dropped.  ";
			$warn .= "That could be disastrous, maybe.  You sure?";
</%perl>

			<a 
				class="full yellow" 
				href="activate_entries.mhtml?tourn_id=<% $tourn->id %>"
				<& "/funclib/confirm.mas", warn => $warn &> 
			>
				Activate All Entries
			</a>

		</div>

	</div>

	<div class="main">

		<span class="fivesixths">
			<h3><% $tourn->name %></h3>
		</span>
		<span 
			id    = "sortable_table_buttonarea"
			class = "sixth rightalign"
		>
		</span>

		<& "/funclib/tablesorter.mas", 
			table => "sortable_table"
		 &>
			
		<table id="sortable_table">

			<thead>

				<tr class="yellowrow">

					<th class="smaller">
						Code
					</th>

					<th class="smaller">
						Name
					</th>

					<th class="smaller">
						School
					</th>

					<th class="smaller">
						Event
					</th>

					<th class="smaller">
						Active
					</th>

				</tr>

			</thead>

			<tbody>

%			foreach my $entry (@entries) { 

				<tr>

					<td class="smallish nowrap">
						<% $entry->code  %> 
					</td>

					<td class="smallish">
						<a 
							class  = "white"
							target = "_blank"
							href   = "/register/entry/edit.mhtml?entry_id=<% $entry->id %>"
						>
							<% $entry->name %>
						</a>
					</td>

					<td class="smallish">
						<% $entry->school->short_name %>
					</td>

					<td class="smallish centeralign">
						<% $entry->event->abbr %>
					</td>

					<td class="smallish nospace centeralign">

						<span class="hidden">
							<% $entry->dropped ? "2" : "1" %>
						</span> 

						<label class="switch">
							<input 
								type          = "checkbox"
								value         = "1"
								id            = "<% $entry->id %>"
								property_name = "active"
								target_id     = "<% $entry->id %>"
								onChange      = "postSwitch( this, '/register/entry/entry_switch.mhtml');"
								<% $entry->active ? 'checked="checked"' : "" %>
							>
							<div class="slider"></div>
						</label>
					</td>

				</tr>
%			}

			</tbody>

		</table>

	</div>

