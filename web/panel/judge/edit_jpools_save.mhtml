<%args>
	$tourn
	$person
	$category_id => undef
</%args>
<%init>

	my $category = Tab::Category->retrieve($category_id);
	$m->abort unless $category;

	foreach my $jpool ($category->jpools) { 

		$jpool->name($ARGS{"name_".$jpool->id});
		$jpool->site($ARGS{"site_".$jpool->id});
		$jpool->update;

		$jpool->setting("publish", $ARGS{"publish_".$jpool->id});
		$jpool->setting("publish", 0) unless $ARGS{"publish_".$jpool->id};

		$jpool->setting("standby", $ARGS{"standby_".$jpool->id});
		$jpool->setting("standby", 0) unless $ARGS{"standby_".$jpool->id};

		$jpool->setting("standby_timeslot", $ARGS{"standby_timeslot_".$jpool->id});
		$jpool->setting("standby_timeslot", 0) unless $ARGS{"standby_timeslot_".$jpool->id};
	}


	my $msg = "Pool settings saved";
	$m->redirect("edit_jpools.mhtml?category_id=".$category->id."&msg=$msg");

</%init>
