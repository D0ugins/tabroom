<%args>
	$tourn
	$person
	$category_id   => undef
	$only_category => undef
</%args>
<%init>

	my $category = Tab::Category->retrieve($category_id) if $category_id;

	$category = $only_category if $only_category;

	$category = $tourn->categories->first unless $category;

	my $whoami = "index" if $category;

</%init>

	<& "menu.mas",
		tourn         => $tourn,
		category      => $category,
		whoami        => $whoami,
		only_category => $only_category 
	&>

	<div class="main">

		<h2><% $category ? $category->name : "Select A Group" %></h2>
	
		<& tabbar.mas, category => $category, whoami => $whoami &>

			<div>
				<span class="half"> 
					<h4>Assign Judges to Rounds</h4>
				</span>
				<span class="half rightalign">
					<h5>For RRs, IEs and Congress only</h5>
				</span>
			</div>

%			my @timeslots = $m->comp("/funclib/category_timeslots.mas", category => $category);

			<div class="yellowrow bold smallish padvert">
				Vital Statistics:
			</div>

			<div class="lightrow marno">

				<span class="half">
					<span class="threequarter nospace">
						Events/Divisions
					</span>
					<span class="quarter nospace">
						<% $category ? scalar $category->events : "" %>
					</span>
				</span>

				<span class="half">
					<span class="threequarter nospace">
						Panels/Rooms
					</span>
					<span class="quarter nospace">
						<% scalar $m->comp("/funclib/category_panels.mas", category => $category) %>
					</span>
				</span>

			</div>

			<div class="lightrow">

				<span class="half">
					<span class="threequarter nospace">
						Max judges needed at one time
					</span>
					<span class="quarter nospace">
						<% $m->comp("/funclib/category_max_judges.mas", category => $category) %>
					</span>
				</span>

				<span class="half">
					<span class="threequarter nospace">
						Timeslots
					</span>
					<span class="quarter nospace">
						<% scalar @timeslots %>
					</span>
				</span>

			</div>

			<br />

			<table>

				<tr class="yellowrow">
					<th colspan="2" class="smallish">
						Repanel judge assignments:
					</th>
				</tr>


				<tr class="lightrow">

					<td class="rightalign">
						<label for="clear" class="hover">
							Erase existing assignments:
						</label>
					</td>
					
					<td>
						<form action="category_judges.mhtml" method="post">

						<input 
							type  = "hidden"
							name  = "category_id"
							value = "<% $category %>"
						>

						<input 
							type    = "checkbox"
							id      = "clear"
							name    = "clear"
							value   = "1"
							checked = "checked"
						>
					</td>

				</tr>

				<tr class="lightrow">

					<td class="rightalign">
						Minimum judges per panel
					</td>
					
					<td>
						<input 
							type  = "number"
							min   = "1"
							max   = "99"
							size  = "5"
							name  = "panelsize"
							value = "1"
						>
					</td>

				</tr>


				<tr class="lightrow">

					<td class="rightalign">
						Timeslot
					</td>
					
					<td>
						<select name="timeslot_id" class="fixedmed chosen">
							<option value="all">All</option>
%							foreach my $timeslot (@timeslots) { 
								<option value="<% $timeslot->id %>"><% $timeslot->name %></option>
%							}
						</select>
					</td>

				</tr>

				<tr class="lightrow">

					<td class="rightalign">
						Round Type
					</td>
					
					<td>
						<select name="round_type" class="fixedmed chosen">
							<option value="all">All</option>
							<option value="prelim">Prelim</option>
							<option value="elim">Elim</option>
							<option value="final">Final</option>
						</select>
					</td>

				</tr>

				<tr class="liblrow">
					<td colspan="2" class="rightalign">
						<input type="submit" value=" Reassign Judges ">
						</form>
					</td>
				</tr>


			</table>



	</div>



