<%args>
	$tourn
	$tourn_settings
	$perms
	$event_id      => undef
	$jpool_id      => undef
	$only_category => undef
	$category_id   => undef
</%args>
<%init>

	my ($event, $eventsref,
		$category, $categoriesref, 
		$jpool, $jpoolsref, $jpool_settingsref, 
		$childrenref) = $m->comp("pools.mas", 
			tourn       => $tourn,
			nsda_nats   => $tourn_settings->{"nsda_nats"},
			perms       => $perms,
			jpool_id    => $jpool_id,
			event_id    => $event_id,
			category_id => $category_id,
		);
			
	my $nats_category = $category->setting("nats_category") if $category;


</%init>

	<& "menu.mas",
		tourn             => $tourn,
		perms             => $perms,
		category          => $category,
		event             => $event,
		jpool             => $jpool,
		nats_category     => $nats_category,
		whoami            => "availability",
		only_category     => $only_category,
		tourn_settings    => $tourn_settings,
		eventsref         => $eventsref,
		childrenref       => $childrenref,
		categoriesref     => $categoriesref,
		jpoolsref         => $jpoolsref,
		jpool_settingsref => $jpool_settingsref,
	&>

	<div class="main">

		<h2><% $category->name %></h2>

%		if ($category) { 	
			<& "tabbar.mas",
				category => $category,
				event    => $event,
				jpool    => $jpool,
				whoami   => "availability"
			&>
%		}

		<h4>Judges availablity in <% $category->abbr %></h4>

%		foreach my $timeslot ($m->comp("/funclib/category_timeslots.mas", category => $category) { 

			<div class="row">

				<span class="fifth">
					<% $timeslot->name%>
				</span>

				<span class="threefifths">

				</span>

				<span class="fifth">
%					my @judge_avail = $m->comp("/funclib/judge_availability.mas", category => $category, timeslot => $timeslot);
					<% scalar @judge_avail %> judges
				</span>

			</div>
%		}

	</div>
