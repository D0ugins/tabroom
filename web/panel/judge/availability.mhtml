<%args>
	$tourn
	$event_id   => undef
	$only_category => undef
	$category_id   => undef
</%args>
<%init>

	my $category = Tab::Category->retrieve($category_id) if $category_id;

	$category = $only_category if $only_category;
	$category = $tourn->categories->first unless $category;

	my $event = Tab::Event->retrieve($event_id) if $event_id;

	$event = $category->events->first unless $event;

	my $switch;

</%init>

	<& menu.mas, tourn => $tourn, category => $category, event => $event, whoami => "availability", only_category => $only_category &>

	<div class="main">

		<h2><% $category->name %></h2>

%		if ($category) { 	
			<& tabbar.mas, category => $category, event => $event, whoami => "availability" &>
%		}

%		if ($event) { 	
		
			<h4>Judge available in <% $event->abbr %></h4>

%		foreach my $round ($event->rounds) { 
	
			<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

				<span class="half">
					<% $round->realname %>
				</span>

				<span class="half">
%					my @judge_avail = $m->comp("/funclib/judge_avail_by_rd.mas", round => $round);
					<% scalar @judge_avail %> judges
				</span>

			</div>

%		}
%		}

	</div>

