<%args>
	$tourn
	$tourn_settings
	$perms
	$session
	$defaults => undef
	$event_id      => undef
	$jpool_id      => undef
	$only_category => undef
	$category_id   => undef
</%args>
<%init>

	my ($event, $eventsref,
		$category, $categoriesref,
		$jpool, $jpoolsref, $jpool_settingsref,
		$childrenref) = $m->comp("pools.mas",
			tourn       => $tourn,
			session     => $session,
			defaults    => $defaults,
			nsda_nats   => $tourn_settings->{"nsda_nats"},
			perms       => $perms,
			jpool_id    => $jpool_id,
			event_id    => $event_id,
			category_id => $category_id,
		);

	my $nats_category = $category->setting("nats_category") if $category;


</%init>

	<& "menu.mas",
		tourn             => $tourn,
		perms             => $perms,
		category          => $category,
		event             => $event,
		jpool             => $jpool,
		nats_category     => $nats_category,
		whoami            => "availability",
		only_category     => $only_category,
		tourn_settings    => $tourn_settings,
		eventsref         => $eventsref,
		childrenref       => $childrenref,
		categoriesref     => $categoriesref,
		jpoolsref         => $jpoolsref,
		jpool_settingsref => $jpool_settingsref,
	&>

	<div class="main">

%		if ($category) {

		<h2><% $category->name %></h2>

			<& "tabbar.mas",
				category => $category,
				event    => $event,
				jpool    => $jpool,
				whoami   => "availability"
			&>

		<h4>Judge Available in <% $category->abbr %></h4>

%		foreach my $timeslot ($m->comp("/funclib/category_timeslots.mas", category => $category)) {

			<div class="row">

				<span class="fifth padvert semibold bluetext">
					<% $timeslot->name %>
				</span>

				<span class="threefifths">
					<% $timeslot->events %>
				</span>

				<span class="fifth">
%					$m->print($m->comp("/funclib/judge_available.mas", category => $category, timeslot => $timeslot));
					judges
				</span>

			</div>
%		}
%		}

	</div>
