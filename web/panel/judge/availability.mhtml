<%args>
	$tourn
	$tourn_settings
	$perms
	$event_id      => undef
	$jpool_id      => undef
	$only_category => undef
	$category_id   => undef
</%args>
<%init>

	my ($event, $eventsref,
		$category, $categoriesref, 
		$jpool, $jpoolsref, $jpool_settingsref, 
		$childrenref) = $m->comp("pools.mas", 
			tourn       => $tourn,
			nsda_nats   => $tourn_settings->{"nsda_nats"},
			perms       => $perms,
			jpool_id    => $jpool_id,
			event_id    => $event_id,
			category_id => $category_id,
		);
			
			
	my $nats_category = $category->setting("nats_category") if $category;

</%init>

	<& "menu.mas",
		tourn             => $tourn,
		perms             => $perms,
		category          => $category,
		event             => $event,
		jpool             => $jpool,
		nats_category     => $nats_category,
		whoami            => "availability",
		only_category     => $only_category,
		tourn_settings    => $tourn_settings,
		eventsref         => $eventsref,
		childrenref       => $childrenref,
		categoriesref     => $categoriesref,
		jpoolsref         => $jpoolsref,
		jpool_settingsref => $jpool_settingsref,
	&>

	<div class="main">

		<h2><% $category->name %></h2>

%		if ($category) { 	
			<& "tabbar.mas",
				category => $category,
				event    => $event,
				jpool    => $jpool,
				whoami   => "availability"
			&>
%		}

%		if ($event) { 	
		
			<h4>Judges available in <% $event->abbr %></h4>

%			foreach my $round ($event->rounds) { 
	
				<div class="lightrow">

					<span class="half">
						<% $round->realname %>
					</span>

					<span class="half">
%						my @judge_avail = $m->comp("/funclib/judge_avail_by_rd.mas", round => $round);
						<% scalar @judge_avail %> judges
					</span>

				</div>

%			}

%		}

	</div>
