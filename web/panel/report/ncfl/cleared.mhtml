<%args>
	$tourn
	$event_id	
	$timeslot_id => undef
	$session
</%args>
<%init>

	my @rounds; 
	my $name;

	if ($timeslot_id && $event_id) { 
		push @rounds, Tab::Round->search(
			timeslot => $timeslot_id,
			event    => $event_id
		);

	if ($timeslot_id) { 

		push @rounds, Tab::Round->search(
			timeslot => $timeslot_id
		);

	} else { 

		push @rounds, Tab::Round->search(
			event => $event_id
		);

	}

	my $file = "ClearingContestants-".$session->id;
	my $filename = $Tab::file_root."/tmp/".$file;

    my $garbage = `rm -f $filename.*`;

    $m->comp("/funclib/printout.mas", 
		tourn    => $tourn,
		filename => $filename,
		head     => 1 
	);

    open (TEXOUT, ">>$filename.tex");

	foreach my $round (@rounds) { 

		my @entries = $m->comp("/funclib/round_entries.mas", round => $round);

		@entries = sort {$a->code <=> $b->code} @entries;

		print TEXOUT "{\\bf \\LARGE ".$round->event->abbr." \\hfill ".$round->realname." } \n";

		print TEXOUT "\\medskip\n";
		print TEXOUT "\\newline\n";

		foreach my $entry (@entries) { 

			print TEXOUT "\\begin{minipage}[t][.35in][t]{1.5in}\n";
			print TEXOUT "{\\large ".$entry->code." } \n";
			print TEXOUT "\\end{minipage}\n";

		}

		print TEXOUT "\\newpage\n";
	}

	close TEXOUT;

    $m->comp("/funclib/printout.mas", 
		tourn    => $tourn,
		filename => $filename,
		tail     => 1
	);

</%init>
