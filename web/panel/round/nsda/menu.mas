<%args>
	$round
	$event
	$round_settings
	$whoami        => undef
	$district      => undef
	$total_quals   => undef
	$alternates    => undef
	$total_entries => undef
</%args>
<%init>

	$event = $round->event if $round && not defined $event;

	my $panel_type = "Pair";
	$panel_type = "Section" if $event->type eq "speech";
	$panel_type = "Chamber" if $event->type eq "congress";

</%init>

	<div class="menu">

		<div class="sidenote">

%			if ($whoami eq "debate") { 
				<a
					id      = "helpswitch"
					class   = "blue full centeralign"
					onclick = 'toggleHelp()'
				>
					Guide to Pairing Debate
				</a>
%			}

			<h4>Other Rounds</h4>

%			foreach my $other_round ($event->rounds) { 

				<a
					class="<% $other_round == $round ? "dk" : "" %>blue half"
					href="<% $whoami %>.mhtml?round_id=<% $other_round->id %>"
				>
					<% $panel_type %>  <% $other_round->realname %>
				</a>

				<a
					class="blue half"
					href="/panel/schemat/show.mhtml?round_id=<% $other_round->id %>"
				>
					Schematic
				</a>
%			}

		</div>

%		if ($round) { 

			<script>

				function switchme(roundid,state) {

					$("#"+roundid).iphoneSwitch(
						state,
						function() { 
							$.post(
								"round_confirm.mhtml", 
								{ round_id: roundid, confirmed: "1" }
							).done(	function(data) { 
								$(".confirmation").html(data);
								$(".judgeassign").removeClass("hidden");
							});
						},
						function() { 
							$.post(
								"round_confirm.mhtml", 
								{ round_id: roundid }
								
							).done(	function(data) { 
								$(".confirmation").html(data);
								$(".judgeassign").addClass("hidden");
							});
						}
					);
				};  

				$(function() { 
					switchme(
						<% $round->id %>,
						"<% $round_settings->{'nsda_confirmed'} ? "on" : "off" %>"
					); 
				});

			</script>

		<div class="sidenote checks screens">

%			if ($event->type eq "speech") { 
				<a 
					class="yellow full"
					href="scramble_order.mhtml?round_id=<% $round->id %>&whoami=<% $whoami %>"
				>(Re)set Speaker Order</a>
%			}

			<h4>Confirm &amp Assign Judges:</h4>

			<div class="lightrow full">

				<span class="twothirds padleft">
					Confirm doublecheck:
				</span>
			
				<span class="third">
					<div 
						class = "phoneswitch"
						id    = "<% $round->id %>" 
					></div>
				</span>
			
			</div>


<%perl>

			my $person_confirmed;

			if ($round_settings->{"nsda_confirmed"}) { 
				$person_confirmed = Tab::Person->retrieve($round_settings->{"nsda_confirmed"});
			}

</%perl>

			<div class="confirmation lightrow full centeralign">
				<% $person_confirmed ? $person_confirmed->email." confirmed" : "" %>
			</div>

		</div>


		<div class="sidenote judgeassign <% $person_confirmed ? "" : "hidden" %>">

			<h4>Assign judges & rooms</h4>

			<span class="full lightrow centeralign">
				<% $round_settings->{"num_judges"} %> 
					judge<% $round_settings->{"num_judges"} != 1 ? "s" : "" %>
					per section
			</span>

%			foreach my $jpool ($round->jpools) { 
				<span class="full lightrow centeralign">
					Draw from <% $jpool->name %>
				</span>
%			}


			<a 
				class="full yellow martop"
				target="_blank"
				href="/panel/round/judges.mhtml?round_id=<% $round->id %>"
			>Auto-assign Judging</a>

			<a 
				class="full yellow martop"
				target="_blank"
				href="/panel/round/rooms.mhtml?round_id=<% $round->id %>"
			>Auto-assign Rooms</a>


			</div>
%		}

<%perl>
	

</%perl>

		<div class="sidenote" >

			<h4>Quals &amp; District</h4>

			<div class="even full padless">
				<span class="twofifths">
					District Level:
				</span>
				<span class="threefifths">
					<% $district->level %>
				</span>
			</div>
			<div class="even full padless">
				<span class="twofifths">
					Total entries:
				</span>
				<span class="threefifths">
					<% $total_entries %>
				</span>
			</div>
			<div class="even full padless">
				<span class="twofifths">
					Total quals:
				</span>
				<span 
					class="threefifths" 
					id="total_quals"
				>
					<% $total_quals %>
				</span>
			</div>
			
		</div>

	</div>

