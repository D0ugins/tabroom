<%args>
	$name        => undef
	$sweep_award => undef
	$sweep_set   => undef
</%args>
<%init>

	my $msg;

	unless ($sweep_award) {
		$m->comp("/funclib/abort.mas",
			message => "No award sent to create ruleset for"
		);
	}

	unless ($name) {
		$m->comp("/funclib/abort.mas",
			message => "Each sweep ruleset needs a name."
		);
	}

	if ($sweep_set) {

		$sweep_set->name($name);
		$sweep_set->update();

		$msg = "Set ".$name." saved";

	}  else {

		$sweep_set = Tab::SweepSet->create({
			sweep_award => $sweep_award->id,
			name        => $name
		});

		$msg = "Set ".$name." created";
	}

	$sweep_set->rule("entries", $ARGS{"entries"});
	$sweep_set->rule("event_entries", $ARGS{"event_entries"});
	$sweep_set->rule("events", $ARGS{"events"});
	$sweep_set->rule("wildcards", $ARGS{"wildcards"});
	$sweep_set->rule("print_limit", $ARGS{"print_limit"});
	$sweep_set->rule("novice_only", $ARGS{"novice_only"});
	$sweep_set->rule("one_per_person", $ARGS{"one_per_person"});
	$sweep_set->rule("by_person", $ARGS{"by_person"});
	$sweep_set->rule("max_entry_persons", $ARGS{"max_entry_persons"});

	$m->redirect("awards.mhtml?sweep_set_id=".$sweep_set->id."&msg=$msg");

</%init>

