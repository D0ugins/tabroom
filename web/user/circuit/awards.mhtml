<%args>
	$person
	$circuit
	$sweep_award_id => undef
</%args>
<%init>

	my %awards = map {$_->id => $_} $circuit->awards();

	my $sweep_award = $awards{$sweep_award_id};

</%init>

	<& menu.mas,
		circuit => $circuit,
		whoami  => "awards"
	&>

	<div class="main">

		<span class="half nospace">
			<h4>
				Cumulative Awards &amp; Qualifying Bids
			</h4>
		</span>
		<span class="half nospace rightalign">

			<form
				action  = "awards.mhtml"
				method  = "post"
			>
				<input
					type  = "hidden"
					name  = "circuit_id"
					value = "<% $circuit->id %>"
				>

				<select
					name     = "sweep_award_id"
					class    = "fixedbig"
					onChange = "this.form.submit();"
				>
					<option value="">
						Add new award/qualification
					</option>

%					foreach my $award_id (sort {$awards{$a} cmp $awards{$b}} keys %awards) {
						<option
							value="<% $award_id %>"
							<% $award_id == $sweep_award_id ? 'selected' : "" %>
						>
							<% $awards{$award_id}->name %>
						</option>
%					}
				</select>
			</form>
		</span>

		<form
			action = "award_save.mhtml"
			method = "post"
		>

			<input
				type  = "hidden"
				name  = "circuit_id"
				value = "<% $circuit->id %>"
			>
			<input
				type  = "hidden"
				name  = "sweep_award_id"
				value = "<% $sweep_award %>"
			>

			<div class="row">
				<span class="third semibold bluetext">
					Name
				</span>
				<span class="twothirds">
					<input
						type  = "text"
						size  = "64"
						name  = "name"
						value = "<% $sweep_award ? $sweep_award->name : "" %>"
					>
				</span>
			</div>

			<div class="row">
				<span class="third semibold bluetext">
					Description
				</span>
				<span class="twothirds">
					<textarea
						type  = "text"
						rows  = "2"
						cols  = "64"
						name  = "description"
					><% $sweep_award ? $sweep_award->description : "" %></textarea>
				</span>
			</div>

			<div class="row">
				<span class="third semibold bluetext">
					Target
				</span>
				<span class="twothirds">
					<label for="entry">
						<span class="third hover">
							<input
								type  = "radio"
								name  = "target"
								id    = "entry"
								value = "entry"
								"<% $sweep_award && $sweep_award->target eq "entry"
									? "checked"
									: ""
								%>"
							>Entries/Teams
						</span>
					</label>
					<label for="individual">
						<span class="third hover">
							<input
								type  = "radio"
								name  = "target"
								id    = "individual"
								"<% $sweep_award && $sweep_award->target eq "individual"
									? "checked"
									: ""
								%>"
								value = "individual"
							>Individual Speakers
						</span>
					</label>
					<label for="school">
						<span class="third hover">
							<input
								type  = "radio"
								name  = "target"
								id    = "school"
								"<% $sweep_award && $sweep_award->target eq "school"
									? "checked"
									: ""
								%>"
								value = "school"
							>Schools/Institutions
						</span>
					</label>
				</span>
			</div>

			<div class="row">
				<span class="third semibold bluetext">
					Period
				</span>
				<span class="twothirds">
					<label for="annual">
						<span class="third hover">
							<input
								type  = "radio"
								name  = "target"
								id    = "annual"
								value = "annual"
								"<% $sweep_award && $sweep_award->target eq "annual"
									? "checked"
									: ""
								%>"
							>
							Annual
						</span>
					</label>
					<label for="cumulative">
						<span class="third hover">
							<input
								type  = "radio"
								name  = "target"
								id    = "cumulative"
								"<% $sweep_award && $sweep_award->target eq "cumulative"
									? "checked"
									: ""
								%>"
								value = "cumulative"
							>
							Cumulative
						</span>
					</label>
				</span>
			</div>

			<div class="row">
				<span class="third semibold bluetext">
					Count the best
				</span>
				<span class="twothirds">
					<span class="third hover">
						<input
							type  = "number"
							min   = "0"
							max   = "9999"
							value = "<% $sweep_award ? $sweep_award->count : "" %>"
						> scores
					</span>
					<span class="third hover italic">
						Leave blank to count all
					</span>
				</span>
			</div>

			<div class="libl row rightalign">
				<span class="third centeralign">
					<input
						type  = "submit"
						value = "Save Award Settings"
					>
				</span>
			</div>
		</form>

%		if ($sweep_award) {

			<h5>Standard Rulesets in <% $sweep_award->label %></h5>

%		}
	</div>
