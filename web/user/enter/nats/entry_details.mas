<%args>
	$tourn 
	$entry  => undef
	$coaches => undef
</%args>
<%init>

	return unless $entry;

	my $event = $entry->event;	
	my $school = $entry->school;

	my %entry_settings = $entry->all_settings();

	unless ($coaches) { 
		@{$coaches} = $m->comp(
			"/funclib/nsda_school_coaches.mas",
			school => $school
		);
	}

	my $now = DateTime->now();

	my $drop_deadline = $tourn->setting("drop_deadline");
	my $supp_deadline = $tourn->setting("supp_deadline");

	my $type;
	$type = "supp" if $event->setting("supp");
	$type = "conn" if $event->setting("conn");
	$type = "main" unless $type;

</%init>

		<div class="padvertmore bordertop">

			<span class="third bigger semibold rightalign">
				<% $event->name %>
			</span>

			<span class="twofifths bigger bluetext semibold padleftmore">
				<% $entry->name %>
			</span>

			<span class="fifth bigger semibold rightalign">
%				if ($entry_settings{"status"} eq "complete") { 
					<span class="greentext">
					<span class="fa fa-check inline"></span> Complete
					</span>
%				} else { 
					<span class="redtext">
					<span class="fa fa-times inline"></span> Incomplete
					</span>
%				}
			</span>

		</div>

		<div class="full nospace bordertop">

			<span class="third rightalign semibold">
				Coach for Points Records
			</span>

			<span class="twothirds">
				<select 
					name="<% $entry->id %>_coach_points"
					class="fixedbig"
				>
					<option value=""></option>

%					foreach my $coach (@{$coaches}) { 
						<option 
							value="<% $coach->ualt_id %>"
							<% $coach->ualt_id == $entry_settings{'coach_points'} 
								? 'selected="selected"'
								: ""
						%>><% $coach->ufname." ".$coach->ulname." (#".$coach->ualt_id.")" %></option>
%					}
				</select>
			</span>

		</div>

		<div class="full nospace bordertop">

			<span class="third rightalign semibold">
				Coach Names for Awards
			</span>

			<span class="twothirds">
				<input
					type  = "text"
					name  = "<% $entry->id %>_coach_script"
					size  = "64"
					value = "<% $entry_settings{"coach_script"} %>"
				>
			</span>

		</div>

%		if ($event->setting('ask_for_titles')) { 

%			my $script = $entry_settings{"script_file"};

			<div class="full nospace bordertop">

				<span class="third rightalign semibold">
					Script/Manuscript:
				</span>

				<span class="third padvert">

					<div class="uploader wider">

						<input 
							type	 = "file"
							name	 = "<% $entry->id %>_script"
							style   = "opacity: 0;"
							onchange = "uploaderName(
								'<% $entry->id %>_script',
								'<% $entry->id %>_script_file'
							)"
							id	 = "<% $entry->id %>_script"
						>

						<span 
							id  = "<% $entry->id %>_script_file"
							class = "filename"
							style = "-webkit-user-select: none;"
						>Upload File</span>

						<span 
							class = "action"
							style = "-webkit-user-select: none;"
						>Choose File</span>
					</div>

				</span>

				<span class="third rightalign padvert">

%				   if ($script) { 

						<span 
							class="fa fa-lg fa-check greentext fifth centeralign">
						</span>

						<a class = "greentext semibold"
						   href  = "<% $Tab::s3_url %>/<% $tourn->id."/".$school->id."/scripts/".$entry->id."/".$script %>" 
						> <% $script %> </a>

%					} else {

						<span 
							class="fa fa-lg fa-times redtext marless"
						></span>

						<span class="semibold redtext align bigger padrightmuchmore marrightmore">
							Not Uploaded
						</span>
%			   		}

				</span>
		
			</div>

			<div class="full nospace bordertop">

				<span class="third rightalign semibold">
					Piece Title
				</span>

				<span class="twothirds">
					<input
						type  = "text"
						name  = "<% $entry->id %>_title"
						size  = "64"
						value = "<% $entry_settings{"title"} %>"
					>
				</span>

			</div>

%		}

%		if ($event->setting('ask_for_authors')) { 

			<div class="full nospace bordertop">

				<span class="third rightalign semibold">
					Piece Author
				</span>

				<span class="half">
					<input 
						type  = "text"
						name  = "<% $entry->id %>_author"
						value = "<% $entry_settings{"author"} %>"
						size  = "64"
					>
				</span>

			</div>

			<div class="semibold bluetext centeralign padvertmore biggish bordertop">
				You must fill out either the Print or Digital
				publication information:
			</div>

			<span class="pagehalf nospace">

				<div class="semibold bluetext centeralign padvertmore biggish">
					Print Publications
				</div>

				<div class="full nospace padtopless bordertop">

					<span class="nospace twofifths rightalign">
						Publisher
					</span>

					<span class="threefifths nospace">
						<input 
							type  = "text"
							name  = "<% $entry->id %>_publisher"
							value = "<% $entry_settings{"publisher"} %>"
							size  = "24"
						>
					</span>

				</div>

				<div class="full nospace ">

					<span class="twofifths nospace rightalign">
						Publication Year
					</span>

					<span class="threefifths nospace">
						<input 
							type  = "text"
							name  = "<% $entry->id %>_publish_date"
							value = "<% $entry_settings{"publish_date"} %>"
							size  = "24"
						>
					</span>

				</div>

				<div class="full nospace ">

					<span class="twofifths nospace rightalign">
						ISBN Number
					</span>

					<span class="threefifths nospace">
						<input 
							type  = "text"
							name  = "<% $entry->id %>_publish_isbn"
							value = "<% $entry_settings{"publish_isbn"} %>"
							size  = "24"
						>
					</span>

				</div>

			</span>

			<span class="pagehalf nospace marleft padleft">

				<div class="semibold bluetext centeralign padvertmore biggish">
					Digital (Online) Publication:
				</div>

				<div class="full nospace bordertop padtopless">

					<span class="twothirds nospace">
						Date the web page was printed:
					</span>

					<& "/funclib/datepicker.mas",
						id => $entry->id."_publish_print_date"
					&>

%					my $publish_print_date = $entry_settings{"publish_print_date"};

					<span class="third centeralign nospace">
						 <input 
							type        = "text"
							name        = "<% $entry->id %>_publish_print_date"
							id          = "<% $entry->id %>_publish_print_date"
							size        = "12"
							placeholder = "MM/DD/YYYY"
							value       = "<% Tab::pickerdate($publish_print_date) %>"
						>
					</span>

				</div>

				<div class="full nospace">

					<span class="quarter nospace">
						URL/Address:
					</span>

					<span class="threequarters rightalign nospace">
						<input 
							type        = "url"
							name        = "<% $entry->id %>_publish_url"
							value       = "<% $entry_settings{"publish_url"} %>"
							size        = "32"
							placeholder = "Script first page if multi-page"
						>
					</span>

				</div>

			</span>

<%perl>

		}


		if (
			( ($type eq "supp" || $type eq "conn") 
		 	 && ($now < $supp_deadline)) 
			|| ($now < $drop_deadline) 
		) { 
</%perl>

			<div class="full centeralign">

				<a 
					class="redtext buttonwhite padless"
					href="reject.mhtml?entry_id=<% $entry->id %>&school_id=<% $school->id %>"
				>
					Drop Entry from <% $event->abbr %>
				</a>

			</div>
%		}




