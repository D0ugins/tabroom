<%args>
	$category_id
	$school_id
</%args>
<%init>

	my $school = Tab::School->retrieve($school_id);

	my $category = Tab::Category->retrieve($category_id);

	my $judge_hire = Tab::JudgeHire->search(
		category => $category->id,
		school   => $school->id
	)->first;

	if ($ARGS{"hires"} > 0) { 

		if ($judge_hire) { 

			$judge_hire->rounds_requested($ARGS{"hires"});
			$judge_hire->rounds_accepted($ARGS{"hires"});
			$judge_hire->update();

		} else { 

			Tab::JudgeHire->create({
				category         => $category->id,
				school           => $school->id,
				rounds_requested => $ARGS{"hires"},
				rounds_accepted  => $ARGS{"hires"}
			});

		}

	} elsif ($judge_hire) { 
		
		$judge_hire->delete();
	}

	my $msg = "Number of hired rounds updated to ".$ARGS{"hires"};

	$m->redirect("judges.mhtml?school_id=".$school->id."&msg=$msg");

</%init>

