<%args>
	$session
	$person
	$person_settings
</%args>
<%init>

	$m->abort unless $person->site_admin;

	my $school_consent = 
		Tab::TournSetting->search( 
			tourn => 0,
			tag   => "school_consent"
		)->first;

	my $nsda_district_email
		= Tab::TournSetting->search( 
			tourn => 0,
			tag   => "nsda_district_email"
		)->first;

	my $nsda_district_jot_email
		= Tab::TournSetting->search( 
			tourn => 0,
			tag   => "nsda_district_jot_email"
		)->first;

	my $nsda_district_open
		= Tab::TournSetting->search( 
			tourn => 0,
			tag   => "nsda_district_open"
		)->first;

	my $nsda_district_deadline
		= Tab::TournSetting->search( 
			tourn => 0,
			tag   => "nsda_district_deadline"
		)->first;

</%init>

	<& ../menu.mas, 
		whoami          => "district_forms",
		person          => $person,
		person_settings => $person_settings
	&>

	<& "/funclib/editor.mas" &>

	<div class="main">

		<h2>NSDA District Settings</h2>

		<form 
			action = "district_forms_save.mhtml"
			method = "post"
		>

		<h4>District Tournament Open/Close</h4>

		<& "/funclib/datepicker.mas", 
			id  => "nsda_district_open",
		&>

		<div class="row">

			<span class="twofifths semibold bluetext">
				District registrations open
			</span>

			<span class="third">
				Date:
				<input 
					type  = "text"
					class = "notfirst"
					name  = "nsda_district_open"
					id    = "nsda_district_open"
					size  = "16"
					value = "<% $nsda_district_open 
						? Tab::pickerdate($nsda_district_open->value_date) 
						: ""
					%>"
				>
			</span>

			<span class="quarter">
				Time:
				 <& "/funclib/timepicker.mas",
					name => "nsda_district_opentime",
					size => 8,
					time => $nsda_district_open->value_date
				 &>
			</span>

		</div>

		<& "/funclib/datepicker.mas", 
			id  => "nsda_district_deadline",
		&>

		<div class="row borderbottom">

			<span class="twofifths semibold bluetext">
				District registrations deadline
			</span>

			<span class="third">
				Date:
				<input 
					type  = "text"
					class = "notfirst"
					name  = "nsda_district_deadline"
					id    = "nsda_district_deadline"
					size  = "16"
					value = "<% $nsda_district_deadline 
						? Tab::pickerdate($nsda_district_deadline->value_date) 
						: ""
					%>"
				>
			</span>

			<span class="quarter">
				Time:
				 <& "/funclib/timepicker.mas",
					name => "nsda_district_deadlinetime",
					size => 8,
					time => $nsda_district_deadline->value_date
				 &>
			</span>

		</div>

		<h4 class="martopmore">
			School Consent Form
		</h4>

		<div class="full row">

			<textarea
				name  = "school_consent"
				cols  = 60
				rows  = 15 
			><% $school_consent ? $school_consent->value_text : "" %></textarea>

		</div>

		<h4>District Chair Preliminary Email</h4>

		<h5>Tabroom using districts:</h5>

		<div class="full row">

			<textarea
				name  = "nsda_district_email"
				cols  = 60
				rows  = 15 
			><% $nsda_district_email 
				? $nsda_district_email->value_text 
				: ""
			%></textarea>

		</div>

		<h5>JOT using districts:</h5>

		<div class="full row">

			<textarea
				name  = "nsda_district_jot_email"
				cols  = 60
				rows  = 15 
			><% $nsda_district_jot_email 
				? $nsda_district_jot_email->value_text 
				: ""
			%></textarea>

		</div>

		<div class="liblrow rightalign">
			<input type="submit" value="Save Districts Settings">
			</form>
		</div>


	</div>

