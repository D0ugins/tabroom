<%args>
	$person
	$paradigm => undef
</%args>
<%init>

	my $tz = $person->tz;
	$tz = "UTC" unless $tz;

	my $now = DateTime->now(time_zone => $tz);

	use HTML::Scrubber;

	if ($paradigm) { 

		my $scrubber = HTML::Scrubber->new( 
			style => 1, 
			allow => [ qw[ p b i u hr br ol ul li strong] ]
		);

		my $text = $scrubber->scrub($paradigm);

		$person->setting("paradigm", 0);
		$person->setting("paradigm", "text", $text);
		$person->setting("paradigm_timestamp", "date", $now);
		$person->update;

	} else { 

		$person->setting("paradigm", 0);
		$person->setting("paradigm_timestamp", 0);
		$person->update;
	}


	$person->update;

	my $msg = "Paradigm saved";
	$m->redirect("/user/judge/paradigm.mhtml?msg=$msg");


</%init>
