<%args>
	$person
</%args>
<%init>

	my $tz = $person->tz;
	$tz = "UTC" unless $tz;

	my $now = DateTime->now(time_zone => $tz);

	my $text = $m->comp(
		"/funclib/save_editor.mas", 
		text => $ARGS{"paradigm"}
	);

	my @paradigms = Tab::PersonSetting->search(
		person => $person->id,
		tag    => "paradigm"
	);

	my @paradigm_ts = Tab::PersonSetting->search(
		person => $person->id,
		tag    => "paradigm_timestamp"
	);

	foreach my (@paradigms, @paradigm_ts) { 
		eval { 
			$_->delete();
		};
	}

	if ($text) { 
		$person->setting("paradigm", "text", $text);
		$person->setting("paradigm_timestamp", "date", $now);
	};

	my $msg = "Paradigm saved";
	$m->redirect("/user/judge/paradigm.mhtml?msg=$msg");

</%init>
