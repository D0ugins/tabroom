<%args>
	$person
	$chapter => undef
	$err     => undef
	$msg     => undef
	$session => undef
</%args>
<%init>

	# Update my own stuff
	$m->comp("/funclib/session_agent.mas",
		session => $session
	);

	$m->comp("/funclib/session_location.mas",
		session => $session,
		update  => 1
	);

	my @judges = $m->comp("/funclib/person_judges.mas", person => $person);

	my @panels = $m->comp("/funclib/person_panels.mas", person => $person) if @judges;

	if (@panels) {
		$m->redirect("/user/judge/panels.mhtml?err=$err&msg=$msg");
	}

	my @entries = $m->comp("/funclib/person_entries.mas", person => $person);

	if (@entries) {
		$m->redirect("/user/student/index.mhtml?err=$err&msg=$msg");
	}

	my @chapters = $m->comp("/funclib/person_chapters.mas", person => $person);

	if (@chapters) {
		$m->redirect("/user/chapter/index.mhtml?err=$err&msg=$msg");
	}

	if (@judges) {
		$m->redirect("/user/judge/index.mhtml?err=$err&msg=$msg");
	}

	my @students = Tab::Student->search(
		person => $person->id
	);

	if (@students) {
		$m->redirect("/user/student/index.mhtml?err=$err&msg=$msg");
	}

	$m->redirect("/user/setup.mhtml?err=$err&msg=$msg");

</%init>

