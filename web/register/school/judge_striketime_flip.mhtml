<%args>
	$school_id
	$judge_id
	$strike_timeslot_id
</%args>
<%init>

	my $strike_timeslot = Tab::StrikeTimeslot->retrieve($strike_timeslot_id);

	my $school = Tab::School->retrieve($school_id);
	my $judge = Tab::Judge->retrieve($judge_id);
	
	my $strike =  $strike_timeslot->strike($judge);

	if ($strike) { 

		$strike->delete;

	} else { 

		my $strike = Tab::Strike->create({
			tourn       => $school->tourn->id,
			strike_timeslot => $strike_timeslot->id,
			type        => "time",
			judge       => $judge->id,
			start       => $strike_timeslot->start,
			end         => $strike_timeslot->end
		});

	}

	$m->redirect("judge_striketime.mhtml?school_id=".$school->id."&judge_id=".$judge->id);

</%init>
