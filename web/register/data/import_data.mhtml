<%args>
	$tourn
	$tourn_settings
	$person
	$session
</%args>
<%init>

	my $ok;
	$ok++ if $person->site_admin;

</%init>

	<& "menu.mas",
		tourn          => $tourn,
		tourn_settings => $tourn_settings,
		person         => $person,
		whoami         => 'import_data',
		ok             => $ok
	&>

	<div class="main">

		<div id="output" class="hidden">

			<h5>File upload results:</h5>

		</div>

		<div id="uploader">

			<h3><% $tourn->name %></h3>

%			my $warning = "Depending on which data you upload, this could potentially erase all the data in your tournament.  Please be sure you are uploading the correct file.  If you're not sure, think about taking a full data backup first.";

			<h5 class="martopmore">Import Tabroom Data</h5>

			<div class="even">

				<& "/funclib/uploader.mas",
					url      => "/api/upload_data.mhtml",
					filename => "tabJSON",
					output   => "output",
					hideme   => "uploader",
					submit   => "Upload Data",
					warning  => $warning
				&>

			</div>

		</div>

		<h5 class="martopmuchmore padtopmore">Import Legacy XML</h5>

		<p class="semibold bluetext">
			Entire Tournament
		</p>

		<form
			name     = "native_xml"
			enctype  = "multipart/form-data"
			action   = "/api/upload_xml.mhtml"
			method   = "post"
		>

		<input
			type  = "hidden"
			name  = "tourn_id"
			value = "<% $tourn->id %>"
		>

		<input
			type  = "hidden"
			name  = "person_id"
			value = "<% $person->id %>"
		>

		<input
			type  = "hidden"
			name  = "session_id"
			value = "<% $session->id %>"
		>

		<div class="even">

			<span class="twofifths">

				<div class="uploader wider">

					<input
						type     = "file"
						name     = "native_xml"
						style    = "opacity: 0;"
						onchange = "uploaderName()"
						id       = "upload"
					>

					<span
						id    = "filename"
						class = "filename"
						style = "-webkit-user-select: none;"
					>No file selected</span>

					<span
						class = "action"
						style = "-webkit-user-select: none;"
					>Choose File</span>

				</div>
			</span>

			<label for="no_prefs_full">
				<span class="twofifth hover">
					Skip Prefs:
						<input
							type    = "checkbox"
							id      = "no_prefs_full"
							name    = "no_prefs"
							value   = "1"
							checked = "checked"
						>
					(for faster uploads)
				</span>
			</label>

			<span class="fifth rightalign">
				<input type="submit" value="Upload Data">
			</span>

		</div>

		</form>

		<p class="semibold bluetext martopmore">
			One Round Only
		</p>

		<div class="even">

			<& "/funclib/uploader.mas",
				url      => "/api/upload_round_xml.mhtml",
				filename => "roundXML",
				output   => "output",
				hideme   => "uploader",
				submit   => "Upload Data",
				warning  => $warning
			&>

		</div>

	</div>


