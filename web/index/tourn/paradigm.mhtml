<%args>
	$judge_id
	$jpool_id
	$tourn    => undef
	$tourn_id => undef
	$person   => undef
</%args>
<%init>

	my $key = $judge_id."-".$jpool_id;

#	return if $m->cache_self( 
#		key        => $key,
#		expires_in => '15m'
#	);

	unless ($tourn) { 
		$tourn = Tab::Tourn->retrieve($tourn_id);
	}

	my $jpool = Tab::JPool->retrieve($jpool_id);
	my $judge = Tab::Judge->retrieve($judge_id);

	Tab::Category->columns(TEMP => "nats");

	unless ($jpool && $jpool->id) { 
		$m->comp("/funclib/abort.mas", 
			message => "No such judge pool"
		);
	}

	my $tag = $jpool->setting("paradigm_form");

	unless ($tag) { 
		$m->comp("/funclib/abort.mas", 
			message => "That judge pool has no paradigms"
		);
	}

	my $category = $jpool->category();

	unless ($category->setting("publish_paradigms")) { 
		$m->comp("/funclib/abort.mas", 
			message => "Those paradigms are not published"
		);
	} else { 
		#needed for the menu to work
		$category->nats("publish_paradigms");
	}

</%init>

	<div class="main">

		<& "title.mas", tourn => $tourn &>

        <& "tabbar.mas", 
			tourn => $tourn, 
			person => $person 
		&>

		<span class="threequarters nospace">
			<h4><% $judge->first." ".$judge->last %> Paradigm</h4>
		</span>

		<span 
			class = "quarter rightalign"
		> <h5><% $jpool->name %></h5> </span>

		<& "/funclib/view_questionnaire.mas", 
			judge  => $judge,
			tag    => $tag,
			noinfo => 1
		&>

	</div>

%	my $id = $category->id;
%	undef $category;

	<& "menu.mas",
		category_id => $id,
		jpool       => $jpool,
		tourn       => $tourn
	&>

