<%args>
	$person => undef
	$category_id => undef
	$tourn_id => undef
</%args>
<%init>

	my $key = $category_id;

	return if $m->cache_self( 
		key        => $key,
		expires_in => '5m'
	);

	my $category = Tab::Category->retrieve($category_id) if $category_id;  
	my $tourn = $category->tourn if $category;
	$tourn = Tab::Tourn->retrieve($tourn_id) unless $tourn;

	$m->abort unless $tourn;
	$m->abort unless $category;

	my $ncfl = $tourn->setting("ncfl");

	my $switch;

	use POSIX;

</%init>

	<& menu.mas, tourn_id => $tourn->id, category_id => $category_id &>

	<div class="main">
		
		<& /index/tourn/title.mas, tourn => $tourn &>

        <& /index/tourn/tabbar.mas, tourn => $tourn, person => $person &>

%		my @judges = sort {$a->last cmp $b->last} $category->judges( active => 1);
%		my $total = scalar @judges;
%		my $count;

		<h4><% $category->abbr %> judge information</h4>

		<div class="third top">

%			foreach my $judge (@judges) {

%				next unless $judge->active;

%				if ($count == ceil($total/3)) {
%					undef $count;
					</div>
					<div class="third top">
%				}

%				$count++;

				<a class="button blue full" href="judge.mhtml?judge_id=<% $judge->id %>&tourn_id=<% $tourn->id %>">

%					if ($ncfl) { 
						<span class="seveneighths">
							<% $judge->code %>
						</span>
%					} else { 
						<span class="quarter">
							<% $judge->code %>
						</span>
						<span class="threequarters leftalign">
							<% $judge->first." ".$judge->last %> 
						</span>
%					}
				</a>

%			}

		</div>

	</div>


