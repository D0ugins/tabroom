<%args>
	$tourn
	$name                        => undef
	$tiebreak_set_id             => undef
	$equal_elims                 => 0
	$forfeits_never_break        => 0
	$tie_middle_rank             => 0
</%args>
<%init>

	my $msg;
	my $tiebreak_set = Tab::TiebreakSet->retrieve($tiebreak_set_id) if $tiebreak_set_id;

	unless ($name) {
		$m->print("You cannot have a nameless tiebreaker set.  please use the back button and continue");
		$m->abort();
	}

	if ($tiebreak_set) {
		$tiebreak_set->name($name) if $name;
		$tiebreak_set->update;
		$msg = "Tiebreak set $name updated";
	} else {

		$tiebreak_set = Tab::TiebreakSet->create({
			tourn => $tourn->id,
			name => $name
		});

		$msg = "Tiebreak set $name created";

	}

	$tiebreak_set->setting("equal_elims", $equal_elims);
	$tiebreak_set->setting("forfeits_never_break", $forfeits_never_break);
	$tiebreak_set->setting("tie_middle_rank", $tie_middle_rank);

	$m->redirect("tiebreaks.mhtml?tiebreak_set_id=".$tiebreak_set->id."&msg=$msg");

</%init>
