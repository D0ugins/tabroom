<%args>
	$tourn
	$category_id           => 0
	$judge_policy          => undef
	$reg_sheet_notice      => undef
	$judge_sheet_notice    => undef
	$public_signups_notice => undef
	$diversity_notice      => undef
</%args>
<%init>

	my $category = Tab::Category->retrieve($category_id) if $category_id;

	$m->abort unless $category;

    my $scrubber = HTML::Scrubber->new( allow => [ qw[ p strong b em i u hr br ol ul li] ] );

	$category->setting("judge_policy", "text",  $scrubber->scrub( $judge_policy));
	$category->setting("reg_sheet_notice", "text",  $scrubber->scrub( $reg_sheet_notice));
	$category->setting("judge_sheet_notice", "text",  $scrubber->scrub( $judge_sheet_notice));
	$category->setting("public_signups_notice", "text",  $scrubber->scrub( $public_signups_notice));
	$category->setting("diversity_notice", "text",  $scrubber->scrub( $diversity_notice));

	my $msg = "Messages saved";

	$m->redirect("messages.mhtml?category_id=".$category->id."&msg=$msg");

</%init>
