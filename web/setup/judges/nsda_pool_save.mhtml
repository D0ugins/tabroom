<%args>
	$tourn
	$category_id
</%args>
<%perl>

	my @settings = ("parli", "prefer", "supp", "hire_price", "hire", "paradigm_form");

	my $category = Tab::Category->retrieve($category_id); 

	foreach my $jpool ($category->jpools) { 

		$jpool->name($ARGS{$jpool->id."_name"});
		$jpool->update;

		foreach my $setting (@settings) { 

			if ($ARGS{$jpool->id."_".$setting}) { 
				$jpool->setting($setting, $ARGS{$jpool->id."_".$setting});
			} else { 
				$jpool->setting($setting, 0)
			}
		}

		$jpool->setting("registrant", 1);
	}

	if ($ARGS{"new_name"}) { 

		my $jpool = Tab::JPool->create({ 
			category => $category_id,
			name     => $ARGS{"new_name"}
		});

		foreach my $setting (@settings) { 
			$jpool->setting($setting, $ARGS{"new_".$setting});
		}

		$jpool->setting("registrant", 1);
	}

	my $msg = "Judge Pool settings saved ";

	$m->redirect("/setup/judges/nsda_pools.mhtml?category_id=".$category_id."&msg=".$msg);

</%perl>
