<%args>
	$tourn
	$category_id
</%args>
<%perl>

	my $category = Tab::Category->retrieve($category_id); 

	foreach my $jpool ($category->jpools) { 

		$jpool->name($ARGS{$jpool->id."_name"});
		$jpool->update;

		$jpool->setting("obligation", $ARGS{$jpool->id."_obligation"});
		$jpool->setting("hire", $ARGS{$jpool->id."_hire"});
		$jpool->setting("parli", $ARGS{$jpool->id."_parli"});
		$jpool->setting("prefer", $ARGS{$jpool->id."_prefer"});
		$jpool->setting("hire_price", $ARGS{$jpool->id."_hire_price"});
		$jpool->setting("registrant", 1);
	}

	if ($ARGS{"new_name"}) { 

		my $jpool = Tab::JPool->create({ 
			category      => $category_id,
			name             => $ARGS{"new_name"}
		});

		$jpool->setting("obligation", $ARGS{"new_obligation"});
		$jpool->setting("hire", $ARGS{"new_hire"});
		$jpool->setting("parli", $ARGS{"new_parli"});
		$jpool->setting("prefer", $ARGS{"new_prefer"});
		$jpool->setting("hire_price", $ARGS{"new_hire_price"});
		$jpool->setting("registrant", 1);
	}

	my $msg = "Judge Pool settings saved ";

	$m->redirect("/setup/judges/nsda_pools.mhtml?category_id=".$category_id."&msg=".$msg);

</%perl>
