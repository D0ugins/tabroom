<%args>
	$tourn
	$tourn_settings
	$event_id => undef
	$add      => undef
	$err      => undef
</%args>
<%init>

	my $tz = $tourn->tz;
	$tz = "UTC" unless $tz;

 	my @categories = sort{$a->name cmp $b->name} $tourn->categories;

	my $event = Tab::Event->retrieve($event_id) if $event_id;

	if (scalar $tourn->events == 1 && not defined $add) {
		$event = $tourn->events->first;
	}

	$m->abort unless $event;

	my $districts = $tourn_settings->{"nsda_district"};


</%init>
	
	<& "/funclib/editor.mas" &>

	<div class="main">

		<h2><% $event->name %></h2>

		<& 
			tabbar.mas, 
			event     => $event,
			districts => $districts,
			whoami    => "ballots"
		&>

		<form action="ballots_save.mhtml" method="post">

		<input 
			type  = "hidden"
			name  = "event_id"
			value = "<% $event->id %>">

%		unless ($event->type eq "speech" || $event->type eq "congress" || $event->type eq "wudc") { 

			<div class="row centeralign">

				<span class="half">

					<span class="twothird">
						Affirmative designation:  
					</span>

					<span class="third">
						<input 
							type      = "text"
							name      = "aff_label"
							size      = "5"
							maxlength = "5"
							value     = "<% $event->setting("aff_label") %>"
						>
					</span>
				</span>

				<span class="half">

					<span class="twothird">
						Negative designation:  
					</span>

					<span class="third">
						<input 
							type      = "text"
							name      = "neg_label"
							size      = "5"
							maxlength = "5"
							value     = "<% $event->setting("neg_label") %>"
						>
					</span>

				</span>
			</div>

%		}

%		if ($event->type eq "wsdc") {
			<label for="wsdc_no_rfd">

				<div class="row hover">
					<span class="fivesixths">
						Double size World Schools ballots (No RFD)
					</span>

					<span class="sixth centeralign">
						<input type="checkbox" id="wsdc_no_rfd" name="wsdc_no_rfd" 
							<% $event->setting("wsdc_no_rfd") ? 'checked="checked"' : "" %> value="1"> 
					</span>
				</div>
			</label>
%		} 


		<h4>Message/Rules for Master Ballots</h4>

		<div class="centeralign martop">
			<textarea 
				class = "full"
				name  = "ballot_rules"
				s     = 10
				cols  = "80"
				wrap  = "virtual"
			><% $event->setting("ballot_rules") %></textarea>

		</div>

		<h4>Message/Rules for Chair Master Ballots</h4>

		<div class="centeralign martop">
			<textarea 
				class = "full"
				name  = "ballot_rules_chair"
				s     = 10
				cols  = "80"
				wrap  = "virtual"
			><% $event->setting("ballot_rules_chair") %></textarea>

		</div>

%		unless ($event->type eq "speech" || $event->type eq "congress" || $event->type eq "wudc") { 

			<div class="full nospace">

				<span class="quarter">
					<h4>Info Boxes</h4>
				</span>

				<span class="threequarters rightalign explain">
					<p>
						Use ellipses (...) to right justify text.  "1AC...8
						min" will right-justify "8 min" with leading dots.
					</p>
				</span>

			</div>
			
			<div>

				<span class="half leftalign">

					<h6>Speech Times:</h6>

					<textarea 	
						class = "half"
						name  = "speech_times"
						s     = 6
						cols  = "36"
						wrap  = "virtual"
						><% $event->setting("speech_times") %></textarea>

				</span>

				<span class="half leftalign ">

					<h6>Point Scale:</h6>

					<textarea 
						class = "half"
						name  = "point_scale"
						s     = 6
						cols  = "36"
						wrap  = "virtual"
						><% $event->setting("point_scale") %></textarea>
				</span>

			</div>

%		} 

		<h4>Instructions/Message for Strike Cards</h4>

		<div class="centeralign">
			<textarea 
				class = "full"
				name  = "strike_card_message"
				s     = 10
				cols  = "59"
				wrap  = "virtual"
				><% $event->setting("strike_card_message") %></textarea>
		</div>

		<div class="liblrow rightalign block">
			<input type="submit"  value="  Save Messages ">
			</form>
		</div>

	</div>
			
	<div class="menu">
		<& menu.mas, tourn => $tourn, whoami => "ballots", event_id => ($event) ? $event->id : "" &>		
	</div>
