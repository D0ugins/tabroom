<%args>
	$tourn
	$tourn_settings
	$person
</%args>
<%init>

	my $err;

	foreach my $key (
		"school_name", "school_street", "school_city",
		"school_state", "school_zip", "school_country",
		"school_street_2",
	) {
		$tourn->setting($key, $ARGS{$key});
	}

	unless ($ARGS{"school_name"}) {
		$err .= "School name required";
	}

	unless ($ARGS{"school_street"}
		&& $ARGS{"school_city"}
		&& ($ARGS{"school_state"} || $ARGS{"school_country"})
		&& ($ARGS{"school_zip"} || $ARGS{"school_country"})
	) {
		$err .= " <br /> " if $err;
		$err .= " School Address required";
	}

	foreach my $key ("disclaimer_1", "disclaimer_2") {

		if ($ARGS{$key}) {
			$tourn->setting($key, $person->id);
		} else {
			$tourn->setting($key, 0);
			$err .= " <br /> " if $err;
			$err .= "You must agree to every disclaimer question";
		}
	}

	if ($ARGS{"use_campus"}) {
		foreach my $key ("disclaimer_3", "disclaimer_4", "disclaimer_5") {
			if ($ARGS{$key}) {
				$tourn->setting($key, $person->id);
			} else {
				$tourn->setting($key, 0);
				$err .= " <br /> " if $err;
				$err .= "You must agree to every disclaimer question";
			}
		}

		my $key = "tech_contact";

		if ($ARGS{$key}) {
			$tourn->setting($key, $person->id);
		} else {
			$tourn->setting($key, 0);
			$err .= " <br /> " if $err;
			$err .= "You must supply a tech contact email";
		}
	}

	if ($err) {
		$m->redirect('payment_register.mhtml?use_campus='.$ARGS{"use_campus"}.'&cart_id='.$ARGS{"cart_id"}."&err=$err");
	} else {
		$m->redirect($Tab::nsda_store_redirect.$ARGS{"cart_id"});
	}

</%init>
