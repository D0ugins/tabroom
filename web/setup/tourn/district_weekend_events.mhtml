<%args>
	$tourn
	$person
</%args>
<%init>

	foreach my $event ($tourn->events) { 

		if ( $event->setting("weekend") ne $ARGS{$event->id} ) { 

			my $description;

			unless ($ARGS{$event->id} eq "nope") { 

				my $weekend = Tab::Weekend->retrieve($ARGS{$event->id});
				$description = "Weekend for ".$event->abbr." changed to ".$weekend->name;

			} else { 

				$description = $event->abbr." changed to not held";

			}

			Tab::ChangeLog->create({ 
				type        => 'districts',
				tourn       => $tourn->id,
				person      => $person->id,
				description => $description
			}); 

			$event->setting("weekend", $ARGS{$event->id});

		}
	}

	my $msg = "Event date set assignments saved";

	$m->redirect("district_dates.mhtml?msg=$msg");

</%init>
