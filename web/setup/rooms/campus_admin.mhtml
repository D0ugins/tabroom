<%args>
	$tourn
	$tourn_settings
	$person
</%args>
<%init>

	unless ($person->site_admin) {
		$m->abort("/funclib/abort.mas", message => "That function is for site admins only.");
	}

	if ($tourn_settings->{"nsda_campus_requested"} ne $ARGS{"nsda_campus_requested"}) {

		Tab::ChangeLog->create({
			tourn       => $tourn,
			tag         => "campus",
			person      => $person,
			description => "Changed NSDA campus room request to ".$ARGS{"nsda_campus_requested"}
		});

		$tourn->setting("nsda_campus_requested", $ARGS{"nsda_campus_requested"});
	}

	if ($tourn_settings->{"nsda_campus_purchased"} ne $ARGS{"nsda_campus_purchased"}) {

		Tab::ChangeLog->create({
			tourn       => $tourn,
			tag         => "campus",
			person      => $person,
			description => "Changed NSDA campus room request to ".$ARGS{"nsda_campus_purchased"}
		});

		$tourn->setting("nsda_campus_purchased", $ARGS{"nsda_campus_purchased"});
	}

	my $msg = "Room allocations changed by admin fiat.  FEEL THE POWER.";
	$m->redirect("nsda_campus.mhtml?msg=$msg");

</%init>
